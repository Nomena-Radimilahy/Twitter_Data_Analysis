knitr::opts_chunk$set(echo = FALSE)
# Datensatz einlesen
twitter <- read.csv("C:/Users/nomen/Twitter_Data_Analysis/data/twitter_data.csv", sep = ",", header = T, stringsAsFactors = T)
head(twitter)
str(twitter)
table(is.na(twitter$IsReplyToStatusId))
twitter_new <- data.frame(Id = twitter$Id, CreatedAt = twitter$CreatedAt, RetweetCount = twitter$RetweetCount, FavoriteCount...LikeCount = twitter$FavoriteCount...LikeCount, Text = twitter$Text, ReplyId = twitter$IsReplyToStatusId, UserFollowersCount = twitter$UserFollowersCount, UserFriendsCount = twitter$UserFriendsCount, UserVerified = twitter$UserVerified)
head(twitter_new)
# Remove Retweets
twitter_new <- twitter_new[!startsWith(as.character(twitter_new$Text), "RT"), ]
str(twitter_new)
# Fehlwerte nochmal checken
sapply(twitter_new, function(x) sum(x %in% c("", " ", "NA", "N/A", "unknown", "Not Available")))
na_count <- sapply(twitter_new, function(x) sum(is.na(x)))
na_count
# explizite Fehlwerte
colSums((is.na(twitter_new)))
rows_with_na <- apply(twitter_new, 1, function(x) any(is.na(x)))
twitter_new[rows_with_na, ]
# Replace NA with Twitter ID
twitter_new <- twitter_new %>%
mutate(ReplyId = ifelse(is.na(ReplyId), Id, ReplyId))
library(dplyr)
# Replace NA with Twitter ID
twitter_new <- twitter_new %>%
mutate(ReplyId = ifelse(is.na(ReplyId), Id, ReplyId))
na_count <- sapply(twitter_new, function(x) sum(is.na(x)))
na_count
colSums((is.na(twitter_new)))
# Filtern Sie zuerst die Tweets, die eine Antwort auf einen anderen Tweet sind
replies <- twitter_new[!is.na(twitter_new$ReplyId) & twitter_new$ReplyId != '', ]
# Gruppieren der Antworten basierend auf der ReplyId
grouped_replies <- split(replies, replies$ReplyId)
# Optional: Betrachten Sie eine spezifische Diskussion
specific_discussion <- grouped_replies[[1]]
# Group by ReplyId and concatenate Text, separate with ". "
discussion <- twitter_new %>%
group_by(ReplyId) %>%
summarise(Text = paste(Text, collapse = ". ")) %>%
ungroup()
discussion
str(discussion)
# Write the data frame to a CSV file
write.csv(discussion, file = "C:/Users/nomen/Twitter_Data_Analysis/Topic_modeling/discussion.csv", row.names = FALSE)
